	AREA acGFMUL, code, readonly	

	THUMB
	EXPORT  acGFMul
	
acGFMul
	LDR  r5 , =log_table

	LDRB  r3 , [r5 , r0]
	ldrb  r2 , [r5 , r1]
	ADDS  r3 , r3 , r2
	LSRS  r4 , r3 , #8
	ADDS  r3 , r3 , r4
	MOVS   r6 , #0xff
	ANDS  r3 , r3 , r6

	LDR   r5 , =exp_table
	LDRB  r2 , [r5 , r3]

	RSBS  r3 , r0 , #0
	ASRS  r4 , r3 , #32
	MOV   r3 , r1
	ANDS  r3 , r3 , r4
	RSBS  r3 , r3 , #0
	ASRS  r4 , r3 , #32
	ANDS  r2 , r2 , r4
	MOVS  r0 , r2 
	BX 		 LR 
	
	
	AREA EXLOGTABLES, data, readonly	
;;	EXPORT  dataSbox
		
log_table
	DCB 0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76 
	DCB 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0
exp_table
	DCB 0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76 
	DCB 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0

	END
